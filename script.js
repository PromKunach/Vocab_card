let original_list = `Bribe : ติดสินบน (v.) 
Detention : การคุมขัง (n.)
Levy : การเก็บภาษี (n.) 
A great deal : เยอะ มาก (adj.)
Abide : ยอมปฏิบัติตาม (v.)
Abound : มีมากมาย ชุกชุม (v.)
Paradigm : เเบบจำลอง ตัวอย่าง (n.)
Hallmark :  เครื่องหมายรับรอง (n.)
Damp : ความชื้น (n.)
Abolish : เลิกล้ม (v.)
Salvage : กอบกู้ (v.)
Canvass : การหาเสียง (n.)
Eager : ความกระตือรือร้น (n.)
Shrewdness : ความเฉลียวฉลาด (n.)
Testimonail : หนังสือรับรอง (n.)
Shrug off : ไม่เอาใจใส่ (phrav.)`;
/*
let original_list = `Bribe : ติดสินบน (v.) 
Detention : การคุมขัง (n.)
Levy : การเก็บภาษี (n.) 
A great deal : เยอะ มาก (adj.)
Abide : ยอมปฏิบัติตาม (v.)
Abbreviation : การย่อคำ (n.)
Jeopardy : อันตราย (n.)
Abound : มีมากมาย ชุกชุม (v.)
Paradigm : เเบบจำลอง ตัวอย่าง (n.)
Hallmark :  เครื่องหมายรับรอง (n.)
Damp : ความชื้น (n.)
Abolish : เลิกล้ม (v.)
Salvage : กอบกู้ (v.)
Canvass : การหาเสียง (n.)
Eager : ความกระตือรือร้น (n.)
Shrewdness : ความเฉลียวฉลาด (n.)
Testimonail : หนังสือรับรอง (n.)
Shrug off : ไม่เอาใจใส่ (phrav.)
Periodic : บางครั้งบางคราว (adj.)
Omit : ละเว้น (v.)
Marginalize : ทำให้ไม่สำคัญ (v.)
Incline : มีเเนวโน้ม (n.)
Legisator : ผู้บัญญัติกฎหมาย (n.)
Leisure : เวลาว่าง (n.)
Permeate : ซึมผ่าน (v.)
Periodical : วารสาร (n.)
Inbound : มาถึง (v.)
Variation : การเปลี่ยนเเปลง (n.)
Shoplifting : การขโมยของตามร้านค้า (n.)
Reception : การรับรอง (n.)
Pick on : การเหน็บเเนม (phrav.)
Deliberate : ตั้งใจ (v.)
Coherent : ซึ่งสอดคล้องกัน (adj.)
Cold call : โทรศัพท์มาเพื่อขายสินค้า (n.)
Delegate : มอบหมายให้ทำเเทน (v.)
Persistent : ดื้อดึง (adj.)
Coalition : สัมพันธมิตร (n.)
Cognition : การรับรู้ (n.)
Harsh : รุนเเรง (adj.)
Adverse : ไม่พึงประสงค์ (adj.)
Admonish : ตักเตือน (v.)
Acclimate : ปรับตัวกับสภาพเเวดล้อม (v.)
Banquet : งานเลี้ยง (n.)
Carry out : ทำให้สำเร็จ (phrav.)
Handicap : อุปสรรค (n.)
Garner : รวบรวม (v.)
Impede : ขัดขวาง (v.)
Elaborate : ละเอียด (adj.)
Tariff : ภาษีศุลกากร (n.)
Garment : เสื้อผ้า (n.)
Abruptly : อย่างทันทีทันใด (adv.)
Scarcity : ความขาดเเคลน (n.)
Savvy : ความรู้ความสามารถ (n.)
Parcel : พัสดุ (n.)
Halt : การหยุดชะงัก (n.)
Parliament : รัฐสภา (n.)
Unanimous : ซึ่งหยุดชะงัก (adj.)
Blunder : ทำพลาด (v.)
Indulge : ดื่มด่ำ (v.)
Aisle : ทางเดินระหว่างที่นั่ง (n.)
Enormous : ใหญ่ (adj.)
Allay : บรรเทา (v.)
Neglect : การละเลย (n.)
Sluggish : พอเพียง (n.)
Headway : ความก้าวหน้า(n.)
Liability : หนี้สิน (n.)
Adequate : พอเพียง (v.)
Alleviate : บรรเทา (adj.)
Catastrophic : ที่เลวร้าย (adj.)
Commence : เริ่มต้น (v.)
Compensate : ชดเชย (v.)
Comprehensive : ครอบคลุม (adj.)
Compromise : ประณีประนอม (v.)
Conseal : ปกปิด (v.)
Consensus : เห็นพ้องกัน (v.)
Constitude : ประกอบด้วย (v.)
Conventional : ตามธรรมเนียม (adj.)
Crucial : สำคัญ (adj.)
Deficiency : การขาดแคลน (n.)
Distinct : ชัดเจน (adj.)
Diverse : หลากหลาย (adj.)
Detrimental : เป็นผลเสีย (adj.)
Apparent : เห็นได้ชัด (adj.)
Diminish : ลดลง (v.)
Discriminate : เลือกปฏิบัติ (v.)
Ethical : มีจริยธรรม (adj.)
Evaluate : ประเมินผล (v.)
Evident : ชัดเจน (adj.)
Exaggerate : กล่าวเกินจริง (v.)
Expertise : ความเชี่ยวชาญ (n.)
Exploit : แสวงหาผลกำไร (v.)
Feasible : เป็นไปได้ (adj.)
Hypothesis : สมมติฐาน (n.)
Inferior : เเย่กว่า (adj.)
Initiate : ริเริ่ม (v.)
Integrate : รวมเข้าด้วยกัน (v.)
Obsolate : ล้าสมัย (adj.)
Persistent : ยืนกราน (v.)
Intriguing : น่าติดตาม (adj.)
Justify : ให้เหตุผล (v.)
Negligible : เล็กน้อย (adj.)
Profound : ลึกซึ้ง (adj.)
Prosperty : ความเจริญรุ่งเรือง (n.)
Reinforce : เสริมสร้าง (v.)
Subsequent : ภายหลัง (adj.)
Substantial : มากมาย (adj.)
Allocate : จัดสรร (v.)
Prevalent : พบได้บ่อยๆ (adj.)
Soar : ทะยานขึ้น (v.)
Foster : ส่งเสริม (v.)
Disperse : กระจาย (v.)
Diminish : ลดลง (v.)
Scrutinize : ตรวจสอบอย่างละเอียด (v.)
Punctual : ตรงต่อเวลา (adj.)
Rekon : คิด (v.)
Endeavor : ความพยายาม (n.)
Convey : เเสดง (v.)
Deteriorate : เสื่อมโทรม (v.)
Affluent : ร่ำรวย (adj.)
Impartial : ไม่เลือกข้าง (adj.)
Vague : ไม่ชัดเจน (adj.)
Tremendous : มหาศาล (adj.)
Impoverished : ยากจน (adj.)
Tranquil : นิ่งสงบ (adj.)
Cunning : ฉลาดเเกมโกง (adj.)
Inquire : สอบถาม (v.)
Enthusiam : กระตือรือร้น (adj.)
Ponder : คิด (v.)
Depict : เเสดง (v.)
Perceive : รับรู้ (v.)
Rectify : แก้ไข (v.)
Coerce : บังคับ (v.)
Alienate : เเยกกัน (v.)
Consolid : รวม (v.)
Mitigate : บรรเทา (v.)
Exacerbate : ทำให้เเย่ลง (v.)
Tendency : เเนวโน้ม (n.)
Deplete : ใช้จนหมด (v.)
Concur : เห็นด้วย (v.)
Emphasize : เน้นย้ำ (v.)
Advocate : สนับสนุน (v.)
Astonish : ทำให้ประหลาดใจ (v.)
Concede : ยอมแพ้ (v.)
Authentic : เเท้จริง (adj.)
Tangible : จับต้องได้ (adj.)
Sporadic : เกิดไม่บ่อย (adj.)
Mandatory : ที่ต้องมี (adj.)
Ailment : เจ็บป่วย (n.)
Infer : สรุป (v.)
Sincere : จริงใจ (adj.)
Relictant : ฝืนใจ (v.)
Interpret : อธิบาย (v.)
Set in stone : ไม่สามารถเปลี่ยนได้ (phrav.)
Superstition : ไสยศาสตร์ (n.)`;
*/
let split_line = original_list.split("\n");

let split_words = [
   
]

function split(text){
    let split_line = text.split("\n");
    return split_line
}

function split_tolist(list){
    split_words.length = 0;
    for (i = 0; i < list.length ; i++){
        let sword = list[i].split(":")[0];
        let smeaning = list[i].split(":")[1];
        split_words.push({word:sword,meaning:smeaning});
    }
   


}

split_tolist(split_line);    

let current_number = 0; 


function print_split(){
    let word_text = document.getElementById("word-eng");
    let meaning_text = document.getElementById("meaning");
    let count_text = document.getElementById("timer");  
    
        let word = split_words[current_number]["word"];
        let meaning = split_words[current_number]["meaning"];
        //console.log(word, "=",meaning);
        word_text.textContent = word;
        count_text.textContent = (current_number+1 + " / " + (split_words.length))
        meaning_text.textContent = meaning;
  
    
}

print_split();

let reveal_mode = 0;

function reveal(){
    let meaning_text = document.getElementById("meaning");  
  
    if (reveal_mode == "0"){
       //meaning_text.style.display = "none";
         meaning_text.style.fontSize = "0rem"
        reveal_mode = 1;
    }
    else if (reveal_mode == "1"){
        //meaning_text.style.display = "block";
        meaning_text.style.fontSize = "1.5rem"
        reveal_mode = 0;
    }
}

function restart(){
    current_number = 0;
   
    print_split();
}

function random_word(){
    let random_num = 9999999
    let new_random = 0;
    new_random = Math.floor(Math.random() * (split_line.length + 1))
    //console.log(new_random);
    while(new_random == random_num){
        new_random = parseInt(Math.random(0,split_line.length))
    }
    random_num = new_random
    current_number = new_random
    
  print_split();
}





function defualt(){
    current_number = 0;

    convert(original_list);
}
function convert(text){
   
    let new_list = split(text);
    split_line = new_list;   
    split_tolist(split_line);
    print_split()
    
}
function submit(){
    split_words.length = 0;
    skipped_words.length = 0;
    current_number = 0;
    let input_form = document.getElementById("convert_form");
    let text = input_form.value;
    convert(text);
    active_converter();
    active_Sidebar();
   split_tolist(split_line);  
   submit_check(split_words);
   //console.log(split_words);
   createGrid();

   print_split();
   skipped_words.length = 0;

}
function submit_check(split_list){
    let alert_text = ""
    for (i = 0;i<split_list.length;i++){
        if((split_list[i]["word"] == "" || split_list[i]["word"] == undefined)&& (split_list[i]["meaning"] == "" ||(split_list[i]["meaning"] == undefined ))){
            alert_text = "word and meaning missing !";
            split_list[i]["word"] = "missing !";
            split_list[i]["meaning"] = "missing !";
            //console.log(alert_text);
        }
        else if((split_list[i]["word"] == "" || split_list[i]["word"] == undefined)){
            alert_text = ("The word which means "+'"'+split_list[i]["meaning"]+'"'+" is missing !");
            split_list[i]["word"] = "missing !";
            //console.log(alert_text);

        }
        else if((split_list[i]["meaning"] == "" ||(split_list[i]["meaning"] == undefined )))
        {
            alert_text = ("The word "+'"'+split_list[i]["word"]+'"'+" is missing its meaning");
            split_list[i]["meaning"] = "missing !";
            //console.log.log(alert_text);

        }
        else{
            alert_text = "success";
            //console.log(alert_text);

        }
    }
}



function scrollIfNotVisible(container, element , type) {
    const containerRect = container.getBoundingClientRect();
    const elementRect = element.getBoundingClientRect();
  
    const isVisible = (
      elementRect.top >= containerRect.top &&
      elementRect.bottom <= containerRect.bottom
    );
  
    if (!isVisible) {
      element.scrollIntoView({ behavior: 'smooth', block: type });
    }
  }



function add(){
    if(current_number+1 < split_words.length){
        current_number += 1;
        
        print_split();
        let grid = document.getElementById("word-list");
        
        if (grid.style.display == "grid"){

        let current_highlight_n = document.getElementById('number-'+current_number);
        let current_highlight_w = document.getElementById('word-'+current_number);
        let current_highlight_m = document.getElementById('meaning-'+current_number);
        document.getElementById('number-'+ (current_number-1)).style.backgroundColor = "rgb(232, 232, 246)";
        document.getElementById('word-'+ (current_number-1)).style.backgroundColor = "rgb(232, 232, 246)" ;
        document.getElementById('meaning-'+ (current_number-1)).style.backgroundColor = "rgb(232, 232, 246)";
        current_highlight_n.style.backgroundColor = 'rgb(193 206 244)';
        current_highlight_w.style.backgroundColor = 'rgb(193 206 244)';
        current_highlight_m.style.backgroundColor = 'rgb(193 206 244)';
        scrollIfNotVisible(grid, current_highlight_n,"start");
    }
        
    }
    else if((current_number + 1 == split_words.length && skipped_words.length > 0)){

        current_number = 0;
        tranfer(skipped_words,split_words);
        print_split();
        createGrid();
        skipped_words.length = 0;
       
    }
    //console.log(current_number + "lenght is " + split_words.length);

}





function subtract(){
   
    if(current_number > 0){
        current_number -= 1;
        print_split();
        
    }
    let grid = document.getElementById("word-list");
        
    if (grid.style.display == "grid"){

    let current_highlight_n = document.getElementById('number-'+current_number);
    let current_highlight_w = document.getElementById('word-'+current_number);
    let current_highlight_m = document.getElementById('meaning-'+current_number);
    document.getElementById('number-'+ (current_number+1)).style.backgroundColor = "rgb(232, 232, 246)";
    document.getElementById('word-'+ (current_number+1)).style.backgroundColor = "rgb(232, 232, 246)" ;
    document.getElementById('meaning-'+ (current_number+1)).style.backgroundColor = "rgb(232, 232, 246)";
    current_highlight_n.style.backgroundColor = 'rgb(193 206 244)';
    current_highlight_w.style.backgroundColor = 'rgb(193 206 244)';
    current_highlight_m.style.backgroundColor = 'rgb(193 206 244)';

    scrollIfNotVisible(grid, current_highlight_n,'end');

}
    console.log(current_number);
  
}

let skipped_words = [
   
]

let skip_count = 0;

function skip(){
    skip_count += 1;

    let list = split_words;
    let sword = list[current_number]["word"];
    let smeaning = list[current_number]["meaning"];
    let skip_text = document.getElementById("skip-counter");
    skip_text.textContent = "skipped : "+ skip_count;

    skipped_words.push({word:sword,meaning:smeaning});
}

const swipe_area = document.getElementById("touch-reveal");
let startX = 0;
let startY = 0;

swipe_area.addEventListener('touchstart', (e) => {
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
});

swipe_area.addEventListener('touchend', (e) => {
    const endX = e.changedTouches[0].clientX;
    const endY = e.changedTouches[0].clientY;

    const diffX = endX - startX;
    const diffY = endY - startY;

    const minimum_swipe = 50;
    if (Math.abs(diffX) > Math.abs(diffY)) {
        if (diffX > minimum_swipe) {
          console.log('Swipe Right');
        } else if (diffX < -minimum_swipe) {
          console.log('Swipe Left');
        }

      } else {
        if (diffY > minimum_swipe) {
          console.log('Swipe Down');
        } else if (diffY < -minimum_swipe) {
            skip();
        }
      }
});






function tranfer(list1,list2){
    console.log(list1);
    console.log(list2);
    list2.length = 0;
    for(i = 0 ;  i<list1.length; i++ ){

        let sword = list1[i]["word"];
      
        let smeaning = list1[i]["meaning"];

        list2.push({word:sword,meaning:smeaning});
    }

   

}



function active_converter(){
    let converter_div = document.getElementById("coverter_container");
    let state = (converter_div.style.display == 'flex') ? 'none' : 'flex';
    converter_div.style.display = state;
    
skipped_words.length = 0;
}

let SideBar_status = 0;

function active_Sidebar(){
    let div = document.getElementById("sidebar");
    if (SideBar_status == 0){
        div.style.display = "block";
        SideBar_status = 1;
    }
    else if (SideBar_status == 1){
        div.style.display = "none";
        SideBar_status = 0;
    }
    let converter_div = document.getElementById("coverter_container");
    converter_div.style.display = 'none';

}

const word_text_en = document.getElementById("word-eng");
const meaning_text_th = document.getElementById("meaning");
const word_list_display = document.getElementById("word-list");

const word_div = document.getElementById("word-div");

function lookup(){
    
    let current_display = word_text_en.style.display;
    let lookup_btn = document.querySelectorAll('.grid-btn');

    let toggle = (current_display == "none") ? 'flex' : 'none';

    let list_toggle = (toggle == "none") ?   'grid': 'none';

    word_text_en.style.display = toggle;
    meaning_text_th.style.display = toggle;
    swipe_area.style.display = toggle;

    word_div.style.display = toggle;
   word_list_display.style.display = list_toggle;

   
   lookup_btn.forEach(btn => {
    btn.style.display = list_toggle;
  
  });

   createGrid();

   



}


function createGrid(){

    let grid = document.getElementById("word-list");

    grid.innerHTML = '';
    for (let i = 0 ;i<split_words.length;i++){
     const number_btn = document.createElement('div');
     number_btn.className = "column-object kanit-regular n_c";
     number_btn.textContent = i+1;
     number_btn.id = "number-" + i;
 
 
     const word_btn = document.createElement('div');
     word_btn.className = "column-object kanit-regular w_c";
     word_btn.textContent = split_words[i]["word"];
     word_btn.id = "word-" + i;
 
     const meaning_btn = document.createElement('div');
     meaning_btn.className = "column-object kanit-regular m_c";
     meaning_btn.textContent = split_words[i]["meaning"];
     meaning_btn.id = "meaning-" + i;
 
     grid.appendChild(number_btn);
     grid.appendChild(word_btn);
     grid.appendChild(meaning_btn);
     
 
 
    }
    let current_highlight_n = document.getElementById('number-'+current_number);
   let current_highlight_w = document.getElementById('word-'+current_number);
   let current_highlight_m = document.getElementById('meaning-'+current_number);



   current_highlight_n.style.backgroundColor = 'rgb(193 206 244)';
   current_highlight_w.style.backgroundColor = 'rgb(193 206 244)';
   current_highlight_m.style.backgroundColor = 'rgb(193 206 244)';
   scrollIfNotVisible(grid, current_highlight_n,"start");

}

function toggle_reveal(){
    let class_obj = document.querySelectorAll('.m_c');
    let original_color = class_obj[0].style.color;
    class_obj.forEach(obj => {

        let toggle = (obj.style.color == 'black') ?'transparent' :  'black';
        obj.style.color = toggle;
    });
    console.log(original_color);
}


function join_word(list){
    let text = "";
    for(let i = 0; i<list.length;i++){
        text = text + list[i]["word"] + " : " +list[i]["meaning"] +"\n";
    }
    console.log(text);
    return(text);
}

join_word(split_words);


function copyToClipboard(text) {
    navigator.clipboard.writeText(text)
      .then(() => {
        console.log('Copied to clipboard!');
      })
      .catch(err => {
        console.error('Failed to copy: ', err);
      });
  }

  function copy_joined_word(){
    let joint_word = join_word(split_words);
    copyToClipboard(joint_word);
  }
  console.log("hii");